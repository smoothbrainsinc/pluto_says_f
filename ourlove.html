<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Just Us</title>
  <style>
    body { background: #0d0d0d; color: #f0e6ff; font-family: sans-serif; padding: 2rem; max-width: 600px; margin: 0 auto; }
    h1 { text-align: center; color: #ff77cc; }
    #messages { background: #1a1a2e; padding: 1rem; border-radius: 8px; margin: 1rem 0; min-height: 200px; }
    textarea, button { width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: #16213e; color: white; border: 1px solid #ff77cc; border-radius: 4px; }
    button { background: #ff77cc; color: #0d0d0d; font-weight: bold; cursor: pointer; }
  </style>
</head>
<body>
  <h1>âœ¨ Just Us âœ¨</h1>
  <div id="messages">Loading...</div>
  <textarea id="note" placeholder="Write something only she should see..."></textarea><br>
  <button onclick="save()">Send</button>
  <button onclick="clearAll()">Clear All</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script>
    const PASSPHRASE = prompt("ðŸ”‘ Secret phrase? (Only you + her know this)");
    if (!PASSPHRASE) { document.body.innerHTML = "<h1>Bye, beautiful.</h1>"; throw ""; }

    const encrypt = (txt) => CryptoJS.AES.encrypt(txt, PASSPHRASE).toString();
    const decrypt = (txt) => CryptoJS.AES.decrypt(txt, PASSPHRASE).toString(CryptoJS.enc.Utf8);

    async function load() {
      try {
        const res = await fetch("notes.txt");
        const encrypted = await res.text();
        const notes = encrypted ? decrypt(encrypted).split("|||").filter(n => n) : [];
        document.getElementById("messages").innerHTML = 
          notes.map(n => `<p>${n}</p>`).join("") || "<p>Empty... for now.</p>";
      } catch(e) { document.getElementById("messages").innerHTML = "<p>ðŸ”’ New here?</p>"; }
    }

    async function save() {
      const note = document.getElementById("note").value.trim();
      if (!note) return;
      const res = await fetch("notes.txt");
      const encrypted = await res.text();
      const oldNotes = encrypted ? decrypt(encrypted).split("|||").filter(n => n) : [];
      const newNotes = [...oldNotes, note];
      const toSave = encrypt(newNotes.join("|||"));
      // GitHub can't write files, so we'll use this trick:
      alert("âœ… Copied! Now:\n1. Press Ctrl+C (Cmd+C)\n2. Go to GitHub\n3. Edit 'notes.txt' with this:");
      prompt("ðŸ“‹ Paste this into notes.txt:", toSave);
      document.getElementById("note").value = "";
    }

    function clearAll() {
      if (confirm("Erase everything forever?")) {
        prompt("ðŸ“‹ Replace notes.txt with this:", encrypt(""));
      }
    }

    load();
  </script>
</body>
</html>
